!function(e){var t=function(t,o){if(!(this instanceof e.utilities.autocomplete))throw new SincoInitializationError("¡Autocomplete requiere ser inicializado mediante new Sinco.utilities.autocomplete()!");if(!e.iconos)throw new SincoInitializationError("¡Autocomplete requiere el objeto Sinco.iconos!");var i,s,n=null,r=-1,a=[],l=window.aplicacion||(window.location.hostname+"_"+window.location.pathname.split("/")[1]+"?").toLowerCase();window.autocompletes=(window.autocompletes||16777272)-1;var u={value:"value",text:"text",viewalldata:!1,data:{props:{},search:""},extended:{north:{title:"",subtitle:""},details:[],border:""},dataSource:void 0,icon:"",placeholder:void 0,orderby:void 0,selectFirst:!0,event:"keyup",service:{method:"GET",url:""},onselected:function(){},onresponse:void 0},p={value:"",text:"",props:{}};this.getSelected=function(){return p},this.setSelectedValue=function(e,t){if(null!=e&&void 0!==e)if(u.dataSource){e=e.toString().toLowerCase();var o,i=-1,s=(t||a).find(function(t,s){return(o=t[u.value].toString().toLowerCase()==e)&&(i=s),o});s||(s=a[0],i=0),x(s),r=i,n.value=s[u.text],y()}else n.value=e,v.call(n,!0);else v.call(n)},this.setParam=function(){if(0==arguments.length)throw new SincoInitializationError('¡Se requieren parámetros en la función "setParam"! Envíe un (objeto) con los parámetros o envíe (nombre, valor).');if("string"==typeof arguments[0]&&void 0===arguments[1])throw new SincoInitializationError("¡Se requiere el valor del parámetro! Se acepta NULL");if("string"==typeof arguments[0])c(arguments[0],arguments[1]);else{var e=u.service.url;for(var t in arguments[0])e=e.split("["+t+"]").join(arguments[0][t]);u.service._url=e}},this.setDataSource=function(e){g(e),u.dataSource=a,a&&!a.length&&(p={value:"",text:"",props:{}},n.value="")},this.setServiceUrl=function(e){u.service._url=e,u.service.url=e,E(e)},this.restart=function(){p={value:"",text:"",props:{}},n.value=""};var c=function(e,t){"GET"==u.service.method?u.service._url=u.service.url.split("["+e+"]").join(t):(u._param=u._param||{},u._param[e]=t)},d=function(e,t){for(var o in t)null===e[o]||"object"!=typeof e[o]||e[o]instanceof Array?e[o]=t[o]:d(e[o],t[o]);return e},h=function(t){27==(t=t||window.event).keyCode&&n._visible?(t.preventDefault(),r=-1,y(),""==n.value.split(" ").join("")?p={value:"",text:"",props:{}}:n.value=p.text):(9==t.keyCode||13==t.keyCode)&&n._visible&&r<0?(y(),r=-1,p={value:"",text:"",props:{}}):(9==t.keyCode||13==t.keyCode)&&n._visible&&r>=0?w.call(e.get(".autocomplete-results-item-"+u.id)[r]):38==t.keyCode&&n._visible?(--r<0&&(r=a.length-1),r>=0&&f(r)):40==t.keyCode?n._visible?(++r>=a.length&&(r=0),r>=0&&f(r)):v.call(n):8!=t.keyCode&&46!=t.keyCode||!n._visible||(y(),r=-1,p={value:"",text:"",props:{}})},m=function(){var t=e.get("inner-container-"+u.id);if(t){var o=t.childNodes;return e.map(o,function(e){return e.classList.remove("hover"),e})}return[]},f=function(t){if(s){x(a[t]),r=t;var o=m();o&&o[t].classList.add("hover");var i=e.get("autocomplete-results-"+u.id);t>=0&&(i.scrollTop=o[t].offsetTop)}},v=function(t){var o=this.value,s={Ok:function(e){b(e,t)}};""===o.split(" ").join("")&&(o="_"),u.dataSource?b("_"==o?u.dataSource:u.dataSource.filter(function(e){return e[u.text].toLowerCase().indexOf(o.toLowerCase())>=0||e[u.value].toString().indexOf(o)>=0})):(i&&i.abort(),"GET"==u.service.method?(u.service._url=u.service._url||u.service.url,i=e.Request(u.service.method,u.service._url.split("["+u.data.search+"]").join(o),s)):(u._param=u._param||{},u._param[u.data.search]=o,i=e.Request(u.service.method,u.service.url,s,u._param)))},x=function(e){if(e){var t={value:e[u.value],text:e[u.text],props:{}};if(u.viewalldata)for(var o in e)t.props[o]=e[o];else for(var o in u.data.props)t.props[o]=e[u.data.props[o]];d(p,t)}},w=function(){this.dataInfo&&(n.value=this.dataInfo[u.text],y(),x(this.dataInfo),u.onselected&&u.onselected(p))},y=function(){I.styles("display","none"),n._visible=!1},g=function(e){var t=u.orderby||u.text;a=e.sort(function(e,o){var i=e[t].toLowerCase?e[t].toLowerCase():e[t],s=o[t].toLowerCase?o[t].toLowerCase():o[t];return i<s?-1:i>s?1:0})},b=function(t,o){void 0!=u.onresponse&&(t=u.onresponse(t)),t?Array.isArray(t)||(t=t.hasOwnProperty("d")?t.d:{length:0}):t={length:0},I.styles("display",""),n._visible=!0,I.innerHTML="";var i,r=e.createElem("div",{id:"inner-container-"+u.id});I.insert(r),0==t.length?((i=e.createElem("div",{class:"autocomplete-results-item-"+u.id})).innerHTML="No se encontraron resultados",r.insert(i),p={value:"",text:"",props:{}},s=!1):(g(t),a.forEach(function(t){if(i=e.createElem("div",{class:"autocomplete-results-item-"+u.id}).addEvent("mouseover",function(){m()}).addEvent("click",w),""!==u.extended.north.title){i.styles("border-left","5px solid "+t[u.extended.border]),i.classList.add("autocomplete-results-item-layout");var o=e.createElem("header"),s=e.createElem("div");s.innerHTML=t[u.extended.north.title],o.insert(s);var n=e.createElem("aside");n.innerHTML=t[u.extended.north.subtitle],o.insert(n),i.insert(o);var a,l=e.createElem("section");u.extended.details.forEach(function(o){var i=t;if(/\./.test(o)){var s=o.split(".");i=i[s[1]]?i:JSON.parse(i[s[0]]),o=s[1]}(a=e.createElem("div")).innerHTML=i[o],l.insert(a)}),i.insert(l)}else i.innerHTML=t[u.text];i.dataInfo=t,r.insert(i)}),s=!0,"keydown"==u.event&&h.call(n),o?w.call({dataInfo:a[0]}):(u.selectFirst||1==a.length)&&f(0)),k()},S=function(e){return u.dimensions.height*e/37},k=function(){var t=e.get("autocomplete-results-"+u.id);if(t){var o=e.get("autocomplete-container-"+u.id).offsetTop+t.offsetTop,i=window.innerHeight-o;i>=30&&i<=300?t.styles("max-height",i+"px"):t.style.maxHeight=null}},E=function(t){var o=t.split("[").shift(),i="";window.parent.getToken?i=window.parent.getToken():localStorage.getItem(l+"_token")&&(i=localStorage.getItem(l+"_token")),i&&""!==i&&e.Request.setHeader(o,"Authorization",i)};if(o&&d(u,o),t&&(n="string"==typeof t?e.get(t):e.extend(t)),!n||"text"!==n.type)throw new SincoInitializationError("¡Autocomplete requiere un input type text para funcionar!");if(!u.service.url&&!u.dataSource)throw new SincoInitializationError("¡Autocomplete requiere una url o un datasource para ejecutar la consulta de los datos!");u.service.url&&E(u.service.url);var _=e.extend(n.parentNode),C=Array.prototype.slice.call(_.childNodes).indexOf(n);u.id=n.id||(new Date).getTime();var L=e.createElem("section",{class:"autocomplete-container",id:"autocomplete-container-"+u.id});L.idResults="autocomplete-results-"+u.id,L.idInput=u.id,L.insert(n),_.insert(L,C),n.styles("-ms-flex","1 1 auto"),n.styles("flex","1 1 auto"),n.attribute("autocomplete","off"),""!==u.icon&&n.styles("padding-left","47px");var j=n.currentStyle||window.getComputedStyle(n);if(u.dimensions={width:n.offsetWidth,height:n.offsetHeight||20,left:parseInt("auto"==j.marginLeft?"0":j.marginLeft.split("px").join(""))||0,top:parseInt("auto"==j.marginTop?"0":j.marginTop.split("px").join(""))||0,right:parseInt("auto"==j.marginRight?"0":j.marginRight.split("px").join(""))||0,bottom:parseInt("auto"==j.marginBottom?"0":j.marginBottom.split("px").join(""))||0},u.icon){var T=e.createElem("aside",{class:"autocomplete-icon",id:"autocomplete-icon-"+u.id});T.insert(e.iconos[u.icon](S(14),"#5A5A5A")),L.insert(T)}var I=e.createElem("div",{class:"autocomplete-results",id:"autocomplete-results-"+u.id,style:"display: none;"}),A=e.createElem("div",{class:"autocomplete-button-search",id:"autocomplete-button-search-"+u.id}).addEvent("click",function(){v.call({value:"_"}),n.focus(),setTimeout(function(){I.styles("display","")},1)});A.insert(e.iconos.Triangulo(S(6),"#5A5A5A")),L.insert(A),L.insert(I);var z=e.createElem("style",{type:"text/css"}),H=[];H.push("#autocomplete-container-"+u.id+" {"),H.push("    position: relative;"),H.push("    display: -ms-flexbox;"),H.push("    display: flex;"),H.push("}"),H.push("#autocomplete-container-"+u.id+" > input {"),H.push("    -ms-flex: 1 1 auto;"),H.push("    flex: 1 1 auto;"),H.push("}"),H.push("#autocomplete-button-search-"+u.id+" {"),H.push("    position: absolute;"),H.push("    top: "+u.dimensions.top+"px;"),H.push("    bottom: "+u.dimensions.bottom+"px;"),H.push("    right: "+u.dimensions.left+"px;"),H.push("    position: absolute;"),H.push("    display: -ms-flexbox;"),H.push("    display: flex;"),H.push("    -ms-flex-align: center;"),H.push("    align-items: center;"),H.push("    -ms-flex-pack: center;"),H.push("    justify-content: center;"),H.push("    width: "+S(18)+"px;"),H.push("    cursor: pointer;"),H.push("}"),H.push("#autocomplete-results-"+u.id+" {"),H.push("    position: absolute;"),H.push("    top: "+(u.dimensions.height+u.dimensions.top-1)+"px;"),H.push("    border-width: 0 1px 1px 1px;"),H.push("    border-style: solid;"),H.push("    border-color: silver;"),""!==u.icon?H.push("    left: "+(u.dimensions.height+1)+"px;"):H.push("    left: 0;"),H.push("    right: "+u.dimensions.right+"px;"),H.push("    border-radius: 0 0 5px 5px;"),H.push("    background-color: #FFF;"),H.push("    z-index: "+window.autocompletes+";"),H.push("    max-height: 300px;"),H.push("    overflow-x: hidden;"),H.push("    overflow-y: auto;"),H.push("    font-size: .75rem;"),H.push("}"),H.push("    #autocomplete-results-"+u.id+" > div > div {"),H.push("        padding: 2px 5px;"),H.push("        cursor: pointer;"),H.push("    }"),""!==u.extended.north.title&&(H.push("    .autocomplete-results-item-"+u.id+".autocomplete-results-item-layout {"),H.push("        display: -ms-flexbox;"),H.push("        display: flex;"),H.push("        -ms-flex-flow: column nowrap;"),H.push("        -webkit-flex-flow: column nowrap;"),H.push("        flex-flow: column nowrap;"),H.push("        border-top: 1px silver solid;"),H.push("        font-size: .75rem;"),H.push("    }"),H.push("    .autocomplete-results-item-"+u.id+".autocomplete-results-item-layout > header {"),H.push("        display: -ms-flexbox;"),H.push("        display: flex;"),H.push("        -ms-flex-flow: row nowrap;"),H.push("        -webkit-flex-flow: row nowrap;"),H.push("        flex-flow: row nowrap;"),H.push("        -ms-flex-pack: justify;"),H.push("        justify-content: space-between;"),H.push("        font-weight: bold;"),H.push("        font-size: .75rem;"),H.push("    }"),H.push("    .autocomplete-results-item-"+u.id+".autocomplete-results-item-layout > header > aside {"),H.push("        margin-right: 10px;"),H.push("    }"),H.push("    .autocomplete-results-item-"+u.id+".autocomplete-results-item-layout > section {"),H.push("        font-size: .75rem;"),H.push("        padding: 3px 0 2px 5px;"),H.push("    }")),H.push("        #autocomplete-results-"+u.id+" > div > div:hover,"),H.push("        #autocomplete-results-"+u.id+" > div > div.hover {"),H.push("            background-color: #1B344C;"),H.push("            color: #FFF;"),H.push("        }"),u.icon&&(H.push("#autocomplete-icon-"+u.id+" {"),H.push("    position: absolute;"),H.push("    top: "+(u.dimensions.top+1)+"px;"),H.push("    bottom: "+(u.dimensions.bottom+1)+"px;"),H.push("    left: "+(u.dimensions.left+1)+"px;"),H.push("    width: "+u.dimensions.height+"px;"),H.push("    border-right: 1px solid silver;"),H.push("    display: -ms-flexbox;"),H.push("    display: flex;"),H.push("    -ms-flex-pack: center;"),H.push("    justify-content: center;"),H.push("    -ms-flex-align: center !important;"),H.push("    align-items: center !important;"),H.push("    background-color: #E6E6E6;"),H.push("    cursor: pointer;"),H.push("    border-radius: 5px 0 0 5px;"),H.push("}"),H.push("    .autocomplete-icon:hover {"),H.push("        background-color: #DAD6D6 !important;"),H.push("    }")),z.innerHTML=H.join("\n"),e.extend(document.head).insert(z);var q=function(){p={value:"",text:"",props:{}},u.onselected&&u.onselected(p)};n.addEvent(u.event,function(e){13!=(e=e||window.event).keyCode&&27!=e.keyCode&&38!=e.keyCode&&40!=e.keyCode?v.call(this):13==e.keyCode&&""==n.value.split(" ").join("")&&q()}),n.addEvent("blur",function(e){""==n.value.split(" ").join("")&&q()}),Array.prototype.map.call(document.querySelectorAll("input, select, button, a"),function(t){e.extend(t).addEvent("focus",function(){e.map(e.get(".autocomplete-container"),function(t){t.id.endsWith(u.id)||(e.get(t.idResults).styles("display","none"),e.get(t.idInput)._visible=!1)})})}),"keydown"!=u.event&&n.addEvent("keydown",function(e){h(e,e.key)}),e.addEvent.call(window,"resize",function(){k()}),n.placeholder=u.placeholder||"Seleccione una opción",n._visible=!1,n.getSelected=this.getSelected,e.utilities.onClickValidations([{target:"autocomplete-container-"+u.id,iguales:!1,excepciones:["autocomplete-results-"+u.id],funcion:function(){n._visible=!1,I.styles("display","none"),m(),r=-1,""==n.value.split(" ").join("")&&(p={value:"",text:"",props:{}})}}])};t.prototype.toString=function(){return JSON.stringify(this.getSelected())},window.Sinco.utilities=window.Sinco.utilities||{},window.Sinco.utilities.autocomplete=t}(Sinco);
//# sourceMappingURL=s5.autocomplete.min.js.map